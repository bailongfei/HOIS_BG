<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xh.dao.QueueSrvGroup">

    <!-- 查询服务项 -->
    <select id="queueSrvGroup" resultType="map"   statementType="CALLABLE" >
		exec queueSrvGroup

	</select>
   <!--查询业务-->
   <select id="queueByCondition" parameterType="map" resultType="map" >

       select qw.Data_ID,qw.RegDate,qw.Queue_No,qw.Queue_Pos,qw.Customer_Name,qw.Customer_No,qw.Customer_ID,qw.Status_Type,qw.Customer_Type,tw.StatusTypeName,sg.SrvGroup_ID,sg.SrvGroup_Name,sg.SrvGroup_Code,ws.WS_ID,ws.WS_Name,sf.Staff_Code,sf.Staff_Name from Basic_Queue_Work qw
		left join Basic_SrvGroup sg on qw.SrvGroup_ID=sg.SrvGroup_ID
		left join Basic_WorkStation ws on qw.WS_ID=ws.WS_ID
		left join Basic_StaffInfo sf on qw.Staff_ID=sf.Staff_ID
		left join StatusType_Work tw on qw.Status_Type=tw.StatusTypeId
		<where>
		    <if test="SrvGroupID!=null and SrvGroupID!=''">
                and  sg.SrvGroup_ID=#{SrvGroupID}
            </if>
            <if test="Customer!=null and Customer!=''">
              and  qw.Customer_ID=#{Customer}
            </if>
            <if test="QueueNo!=null and QueueNo!=''">
              and  qw.Queue_No=#{QueueNo}
            </if>
            <if test="StatusType!=null and StatusType!=''">
              and   qw.Status_Type=#{StatusType}
            </if>
            <if test="WSID!=null and WSID!=''">
              and  qw.WS_ID=#{WSID}
            </if>
        </where>
       order by Customer_Type,Queue_Pos,Data_ID asc
   </select>
    <!--过号激活-->
    <select id="QueueAct" parameterType="map" resultType="map" statementType="CALLABLE">
        exec SP_MS_Queue_Act
        #{Data_ID,mode=IN,jdbcType=NUMERIC}
    </select>
    <!--指定呼叫-->
    <select id="Queue_ZDHJ" parameterType="map" statementType="CALLABLE">
        execute SP_WS_Queue_ZDHJ
        #{Data_ID,mode=IN,jdbcType=NUMERIC},
        #{WSID,mode=IN,jdbcType=NUMERIC},
        #{StaffCode,mode=IN,jdbcType=VARCHAR}
    </select>
    <!--客户照顾-->
    <select id="QueueZG" parameterType="map" resultType="map">
        exec SP_MS_Queue_ZG
        #{Data_ID,mode=IN,jdbcType=NUMERIC}
    </select>
    <!--查询工作站窗口-->
    <select id="QueueWSID"  resultType="map">
        select ws.*,wsw.Staff_ID,wsw.Staff_Code,wsw.WS_Status_Type,wsw.WS_Preiod_Work,wsw.DataID from Basic_WorkStation ws left join Basic_WorkStation_Work wsw on ws.WS_ID=wsw.WS_ID
    </select>

</mapper>